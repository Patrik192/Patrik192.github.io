<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–∞—Ä—Ç–∞ - –°–ü–± –ì–ë–ü–û–£ ¬´–ú–ö –∏–º.–í.–ú.–ë–µ—Ö—Ç–µ—Ä–µ–≤–∞¬ª">
<meta name="author" content="–°–ü–± –ì–ë–ü–û–£ ¬´–ú–ö –∏–º.–í.–ú.–ë–µ—Ö—Ç–µ—Ä–µ–≤–∞¬ª">
<meta name="theme-color" content="#0e585c">
<title>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–∞—Ä—Ç–∞</title>
<!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–¥—ë–∂–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ DOCX -->
<script src="https://unpkg.com/docx@7.4.1/build/index.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
body {
background: linear-gradient(135deg, #0e585c 0%, #0e585c 100%);
min-height: 100vh;
display: flex;
flex-direction: column;
justify-content: center;
align-items: center;
padding: 20px;
position: relative;
}
.page-title {
background: #0e585c;
border-radius: 20px;
padding: 15px 30px;
color: #fff;
font-size: 30px;
text-align: center;
max-width: 1800px;
width: 100%;
margin: 0 auto 20px;
}
.container {
background: white;
border-radius: 20px;
padding: 30px;
box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
max-width: 1000px;
width: 100%;
height: auto;
max-height: 100%;
overflow-y: auto;
position: relative;
z-index: 10;
}
.operator-container {
background: white;
border-radius: 20px;
padding: 40px;
box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
max-width: 600px;
width: 100%;
text-align: center;
}
.form-section {
margin-bottom: 25px;
padding-bottom: 20px;
border-bottom: 2px solid #f0f0f0;
}
.form-section:last-child {
border-bottom: none;
margin-bottom: 0;
padding-bottom: 0;
}
.section-title {
color: #0e585c;
font-size: 22px;
margin-bottom: 15px;
padding-bottom: 8px;
border-bottom: 2px solid #667eea;
display: flex;
align-items: center;
gap: 10px;
}
.section-title i {
font-size: 24px;
}
.form-row {
display: flex;
gap: 15px;
flex-wrap: wrap;
margin-bottom: 15px;
}
.form-group {
flex: 1;
min-width: 200px;
}
.form-group label {
display: block;
margin-bottom: 6px;
color: #333;
font-weight: 600;
font-size: 14px;
}
.form-group input,
.form-group select,
.form-group textarea {
width: 100%;
padding: 12px;
font-size: 15px;
border: 2px solid #ddd;
border-radius: 8px;
outline: none;
transition: border-color 0.3s;
background: #f9f9f9;
}
.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
border-color: #667eea;
background: white;
box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
.form-group textarea {
min-height: 80px;
resize: vertical;
line-height: 1.6;
}
.required::after {
content: " *";
color: #dc3545;
}
.checkbox-group {
display: flex;
gap: 20px;
flex-wrap: wrap;
margin-top: 8px;
}
.checkbox-item {
display: flex;
align-items: center;
gap: 6px;
cursor: pointer;
}
.checkbox-item input[type="checkbox"] {
width: auto;
cursor: pointer;
}
.radio-group {
display: flex;
gap: 20px;
flex-wrap: wrap;
margin-top: 8px;
}
.radio-item {
display: flex;
align-items: center;
gap: 6px;
cursor: pointer;
}
.radio-item input[type="radio"] {
width: auto;
cursor: pointer;
}
.controls {
display: flex;
gap: 10px;
margin-top: 25px;
margin-bottom: 15px;
flex-wrap: wrap;
align-items: center;
justify-content: center;
}
.btn {
padding: 12px 24px;
border: none;
border-radius: 8px;
font-size: 15px;
cursor: pointer;
transition: all 0.3s;
font-weight: 600;
white-space: nowrap;
display: flex;
align-items: center;
gap: 8px;
}
.btn i {
font-size: 16px;
}
.btn-primary {
background: #667eea;
color: white;
}
.btn-primary:hover {
background: #5568d3;
transform: translateY(-2px);
box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}
.btn-secondary {
background: #6c757d;
color: white;
}
.btn-secondary:hover {
background: #5a6268;
}
.btn-success {
background: #28a745;
color: white;
}
.btn-success:hover {
background: #218838;
}
.btn-danger {
background: #dc3545;
color: white;
}
.btn-danger:hover {
background: #c82333;
}
.btn-outline {
background: transparent;
border: 2px solid #667eea;
color: #667eea;
}
.btn-outline:hover {
background: #667eea;
color: white;
}
.btn-start {
background: #28a745;
color: white;
font-size: 18px;
padding: 16px 32px;
margin: 20px 0;
width: 100%;
max-width: 400px;
}
.btn-start:hover {
background: #218838;
transform: scale(1.02);
box-shadow: 0 8px 25px rgba(40, 167, 69, 0.5);
}
.btn-end {
background: #dc3545;
color: white;
font-size: 16px;
padding: 12px 24px;
width: 100%;
max-width: 200px;
margin: 10px auto;
}
.btn-end:hover {
background: #c82333;
}
.btn-enter {
background: #0e585c;
color: white;
font-size: 18px;
padding: 16px 32px;
margin: 20px auto;
width: 100%;
max-width: 250px;
}
.btn-enter:hover {
background: #0a4345;
transform: scale(1.02);
box-shadow: 0 8px 25px rgba(14, 88, 92, 0.5);
}
.info-box {
background: #e3f2fd;
border-left: 4px solid #667eea;
padding: 12px;
border-radius: 4px;
margin: 15px 0;
font-size: 14px;
color: #0d47a1;
}
.info-box strong {
color: #0e585c;
}
.error-box {
background: #ffebee;
border-left: 4px solid #dc3545;
padding: 12px;
border-radius: 4px;
margin: 15px 0;
font-size: 14px;
color: #c62828;
display: none;
}
.success-box {
background: #e8f5e9;
border-left: 4px solid #28a745;
padding: 12px;
border-radius: 4px;
margin: 15px 0;
font-size: 14px;
color: #1b5e20;
display: none;
}
.patient-id {
background: #f8f9fa;
padding: 10px 15px;
border-radius: 8px;
margin-bottom: 15px;
font-size: 16px;
font-weight: bold;
color: #0e585c;
text-align: center;
border: 2px dashed #667eea;
}
.form-footer {
background: #f8f9fa;
padding: 15px;
border-radius: 10px;
margin-top: 20px;
text-align: center;
font-size: 13px;
color: #6c757d;
}
.operator-info {
background: #f8f9fa;
padding: 15px;
border-radius: 10px;
margin-bottom: 20px;
text-align: center;
font-size: 15px;
color: #0e585c;
font-weight: bold;
}
.operator-info span {
color: #667eea;
}
.invalid-email {
border-color: #dc3545 !important;
background-color: #fff8f8 !important;
}
.email-error {
color: #dc3545;
font-size: 12px;
margin-top: 4px;
display: none;
}
.other-disease-input {
margin-top: 10px;
display: none;
}
.other-disease-input input {
width: 100%;
padding: 10px;
font-size: 14px;
border: 2px solid #ddd;
border-radius: 6px;
outline: none;
transition: border-color 0.3s;
}
.other-disease-input input:focus {
border-color: #667eea;
box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
.loading {
display: inline-block;
width: 16px;
height: 16px;
border: 2px solid rgba(255,255,255,0.3);
border-radius: 50%;
border-top-color: white;
animation: spin 1s linear infinite;
margin-right: 8px;
}
@keyframes spin {
to { transform: rotate(360deg); }
}
/* –¢–∞–π–º–µ—Ä - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É */
.timer-container {
position: fixed;
right: calc((100% - 2000px) / 2 + 30px);
top: 50%;
transform: translateY(-50%);
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
border-radius: 15px;
padding: 20px;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
border: 3px solid #0e585c;
z-index: 1000;
min-width: 200px;
text-align: center;
transition: all 0.3s ease;
}
.timer-container.hidden {
opacity: 0;
pointer-events: none;
transform: translateY(-50%) scale(0.9);
}
.timer-title {
font-size: 14px;
color: #6c757d;
margin-bottom: 10px;
font-weight: 600;
}
.timer-display {
font-size: 48px;
font-weight: bold;
color: #0e585c;
font-family: 'Courier New', monospace;
margin: 10px 0;
letter-spacing: 2px;
}
.timer-status {
font-size: 12px;
color: #28a745;
font-weight: 600;
margin-top: 8px;
text-transform: uppercase;
letter-spacing: 1px;
}
.timer-status.stopped {
color: #dc3545;
}
.hidden {
display: none !important;
}
.change-operator-container {
text-align: center;
margin: 20px 0 15px;
}
.change-operator-container .btn {
width: auto;
min-width: 200px;
}
@media (max-width: 1200px) {
.timer-container {
right: 15px;
min-width: 180px;
}
.timer-display {
font-size: 36px;
}
}
@media (max-width: 768px) {
.timer-container {
position: fixed;
right: 10px;
top: 20px;
transform: none;
min-width: 160px;
border-radius: 12px;
padding: 15px;
}
.timer-display {
font-size: 32px;
}
.container, .operator-container {
padding: 15px;
}
.form-row {
flex-direction: column;
gap: 10px;
}
.form-group {
min-width: 100%;
}
.checkbox-group, .radio-group {
flex-direction: column;
gap: 8px;
}
.controls {
flex-direction: column;
align-items: stretch;
}
.btn {
width: 100%;
justify-content: center;
}
.section-title {
font-size: 20px;
}
}
@media (max-width: 480px) {
.page-title {
font-size: 24px;
padding: 10px 15px;
}
.container, .operator-container {
padding: 10px;
}
.btn {
padding: 10px 15px;
font-size: 14px;
}
.timer-container {
right: 10px;
top: 15px;
min-width: 140px;
padding: 12px;
}
.timer-display {
font-size: 28px;
}
.timer-title {
font-size: 12px;
}
.change-operator-container .btn {
min-width: 100%;
padding: 10px 15px;
}
}
</style>
</head>
<body>
<header class="page-header">
<h1 class="page-title">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–∞—Ä—Ç–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –°–ü–± –ì–ë–ü–û–£ ¬´–ú–ö –∏–º.–í.–ú.–ë–µ—Ö—Ç–µ—Ä–µ–≤–∞¬ª</h1>
</header>
<!-- –¢–∞–π–º–µ—Ä —Å–ø—Ä–∞–≤–∞ –ø–æ —Ü–µ–Ω—Ç—Ä—É -->
<div class="timer-container hidden" id="timer-container">
<div class="timer-title">‚è±Ô∏è –í—Ä–µ–º—è –≤–≤–æ–¥–∞</div>
<div class="timer-display" id="timer-display">00:00:00</div>
<div class="timer-status" id="timer-status">–û–∂–∏–¥–∞–Ω–∏–µ</div>
</div>
<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ (—Å—Ç—É–¥–µ–Ω—Ç–∞) -->
<div class="operator-container" id="operator-container">
<h2 style="color: #0e585c; margin-bottom: 20px;">üë§ –î–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞</h2>
<p style="font-size: 16px; margin-bottom: 25px; color: #555;">
<strong>–£–∫–∞–∂–∏—Ç–µ —Å–≤–æ—ë –§–ò–û –∏ –Ω–æ–º–µ—Ä –≥—Ä—É–ø–ø—ã</strong>
</p>
<div class="form-group" style="margin-bottom: 15px;">
<label for="operator-name" class="required">–§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞</label>
<input type="text" id="operator-name" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" style="font-size: 16px; padding: 14px;">
</div>
<div class="form-group" style="margin-bottom: 25px;">
<label for="operator-group" class="required">‚Ññ –≥—Ä—É–ø–ø—ã</label>
<input type="text" id="operator-group" placeholder="301" style="font-size: 16px; padding: 14px;">
</div>
<button class="btn btn-enter" id="operator-enter-btn">
<span>‚úÖ</span> –í–≤–æ–¥
</button>
<div class="error-box" id="operator-error-box" style="margin-top: 15px;">
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è.
</div>
</div>
<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Ñ–æ—Ä–º–æ–π –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç) -->
<div class="container hidden" id="patient-container">
<div class="operator-info" id="operator-info-display">
–°—Ç—É–¥–µ–Ω—Ç: <span id="operator-name-display">-</span>, –ì—Ä—É–ø–ø–∞: <span id="operator-group-display">-</span>
</div>
<!-- –ö–Ω–æ–ø–∫–∞ "–°–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞" –ø–æ —Ü–µ–Ω—Ç—Ä—É -->
<div class="change-operator-container">
<button class="btn btn-primary" id="change-operator-btn">
<span>üîÑ</span> –°–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
</button>
</div>
<div class="patient-id">
ID –ø–∞—Ü–∏–µ–Ω—Ç–∞: <span id="patient-id">PAT-2026-0001</span>
<br>
<small>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: <span id="creation-date">09.02.2026</span></small>
</div>
<div class="info-box">
<strong>–í–Ω–∏–º–∞–Ω–∏–µ:</strong> –ü–æ–ª—è, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –∑–≤–µ–∑–¥–æ—á–∫–æ–π (*), —è–≤–ª—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è.
</div>
<div class="error-box" id="error-box">
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è.
</div>
<div class="success-box" id="success-box">
–î–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!
</div>
<!-- –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –≤–≤–æ–¥" -->
<button class="btn btn-start" id="start-input-btn">
üöÄ –ù–∞—á–∞—Ç—å –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
</button>
<!-- –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
<div class="form-section">
<h2 class="section-title">üë§ –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞</h2>
<div class="form-row">
<div class="form-group">
<label for="lastName" class="required">–§–∞–º–∏–ª–∏—è</label>
<input type="text" id="lastName" placeholder="–ò–≤–∞–Ω–æ–≤" disabled>
</div>
<div class="form-group">
<label for="firstName" class="required">–ò–º—è</label>
<input type="text" id="firstName" placeholder="–ò–≤–∞–Ω" disabled>
</div>
<div class="form-group">
<label for="middleName">–û—Ç—á–µ—Å—Ç–≤–æ</label>
<input type="text" id="middleName" placeholder="–ò–≤–∞–Ω–æ–≤–∏—á" disabled>
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="birthDate" class="required">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
<input type="date" id="birthDate" disabled>
</div>
<div class="form-group">
<label for="gender" class="required">–ü–æ–ª</label>
<select id="gender" disabled>
<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
<option value="male">–ú—É–∂—Å–∫–æ–π</option>
<option value="female">–ñ–µ–Ω—Å–∫–∏–π</option>
</select>
</div>
<div class="form-group">
<label for="age">–í–æ–∑—Ä–∞—Å—Ç (–∞–≤—Ç–æ)</label>
<input type="text" id="age" readonly disabled>
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="phone" class="required">–¢–µ–ª–µ—Ñ–æ–Ω</label>
<input type="tel" id="phone" placeholder="+7 (999) 123-45-67" disabled>
</div>
<div class="form-group">
<label for="email">Email</label>
<input type="email" id="email" placeholder="patient@example.com" disabled>
<div class="email-error" id="email-error">E-mail –Ω–µ –≤–µ—Ä–Ω—ã–π! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤–≤–æ–¥–∞</div>
</div>
</div>
<div class="form-group">
<label for="address">–ê–¥—Ä–µ—Å –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è</label>
<textarea id="address" placeholder="–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1, –∫–≤. 1" disabled></textarea>
</div>
</div>
<!-- –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
<div class="form-section">
<h2 class="section-title">üìÑ –ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>
<div class="form-row">
<div class="form-group">
<label for="passportSeries">–°–µ—Ä–∏—è –ø–∞—Å–ø–æ—Ä—Ç–∞</label>
<input type="text" id="passportSeries" placeholder="1234" maxlength="4" disabled>
</div>
<div class="form-group">
<label for="passportNumber">–ù–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞</label>
<input type="text" id="passportNumber" placeholder="567890" maxlength="6" disabled>
</div>
<div class="form-group">
<label for="passportIssueDate">–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏</label>
<input type="date" id="passportIssueDate" disabled>
</div>
</div>
<div class="form-group">
<label for="passportIssuedBy">–ö–µ–º –≤—ã–¥–∞–Ω</label>
<input type="text" id="passportIssuedBy" placeholder="–û–í–î —Ä–∞–π–æ–Ω–∞ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞" disabled>
</div>
</div>
<!-- –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
<div class="form-section">
<h2 class="section-title">üè• –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
<div class="form-row">
<div class="form-group">
<label for="insuranceNumber">–°–ù–ò–õ–°</label>
<input type="text" id="insuranceNumber" placeholder="123-456-789 00" disabled>
</div>
<div class="form-group">
<label for="policyNumber">–ù–æ–º–µ—Ä –ø–æ–ª–∏—Å–∞ –û–ú–°</label>
<input type="text" id="policyNumber" placeholder="1234567890123456" disabled>
</div>
<div class="form-group">
<label for="bloodType">–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏</label>
<select id="bloodType" disabled>
<option value="">–ù–µ —É–∫–∞–∑–∞–Ω–æ</option>
<option value="1+">I (+)</option>
<option value="1-">I (-)</option>
<option value="2+">II (+)</option>
<option value="2-">II (-)</option>
<option value="3+">III (+)</option>
<option value="3-">III (-)</option>
<option value="4+">IV (+)</option>
<option value="4-">IV (-)</option>
</select>
</div>
</div>
<div class="form-group">
<label>–•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è</label>
<div class="checkbox-group">
<label class="checkbox-item">
<input type="checkbox" name="chronic" value="hypertension" disabled>
–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è
</label>
<label class="checkbox-item">
<input type="checkbox" name="chronic" value="diabetes" disabled>
–°–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç
</label>
<label class="checkbox-item">
<input type="checkbox" name="chronic" value="asthma" disabled>
–ë—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–∞—è –∞—Å—Ç–º–∞
</label>
<label class="checkbox-item">
<input type="checkbox" name="chronic" value="heartDisease" disabled>
–°–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
</label>
<label class="checkbox-item">
<input type="checkbox" name="chronic" value="thyroid" disabled>
–ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è —â–∏—Ç–æ–≤–∏–¥–Ω–æ–π –∂–µ–ª–µ–∑—ã
</label>
<label class="checkbox-item" id="other-checkbox">
<input type="checkbox" name="chronic" value="other" disabled>
–î—Ä—É–≥–æ–µ
</label>
</div>
<div class="other-disease-input" id="other-disease-input">
<input type="text" id="otherDiseaseText" placeholder="–£–∫–∞–∂–∏—Ç–µ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ" disabled>
</div>
</div>
<div class="form-group">
<label for="allergies">–ê–ª–ª–µ—Ä–≥–∏–∏ (—É–∫–∞–∂–∏—Ç–µ, –µ—Å–ª–∏ –µ—Å—Ç—å)</label>
<textarea id="allergies" placeholder="–õ–µ–∫–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã, –ø—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è, —Ç.–¥." disabled></textarea>
</div>
<div class="form-group">
<label for="medications">–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã</label>
<textarea id="medications" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞, –¥–æ–∑–∏—Ä–æ–≤–∫–∞, —á–∞—Å—Ç–æ—Ç–∞ –ø—Ä–∏–µ–º–∞" disabled></textarea>
</div>
</div>
<!-- –¢–µ–∫—É—â–µ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ -->
<div class="form-section">
<h2 class="section-title">üìù –¢–µ–∫—É—â–µ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ</h2>
<div class="form-row">
<div class="form-group">
<label for="visitDate" class="required">–î–∞—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è</label>
<input type="date" id="visitDate" value="2026-02-09" disabled>
</div>
<div class="form-group">
<label for="visitType" class="required">–¢–∏–ø –æ–±—Ä–∞—â–µ–Ω–∏—è</label>
<select id="visitType" disabled>
<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
<option value="primary">–ü–µ—Ä–≤–∏—á–Ω–æ–µ</option>
<option value="followup">–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ</option>
<option value="emergency">–≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ</option>
<option value="planned">–ü–ª–∞–Ω–æ–≤–æ–µ</option>
</select>
</div>
<div class="form-group">
<label for="department">–û—Ç–¥–µ–ª–µ–Ω–∏–µ</label>
<select id="department" disabled>
<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ</option>
<option value="therapy">–¢–µ—Ä–∞–ø–µ–≤—Ç–∏—á–µ—Å–∫–æ–µ</option>
<option value="surgery">–•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–æ–µ</option>
<option value="neurology">–ù–µ–≤—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ</option>
<option value="psychiatry">–ü—Å–∏—Ö–∏–∞—Ç—Ä–∏—á–µ—Å–∫–æ–µ</option>
<option value="cardiology">–ö–∞—Ä–¥–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ</option>
</select>
</div>
</div>
<div class="form-group">
<label for="complaints" class="required">–ñ–∞–ª–æ–±—ã –ø–∞—Ü–∏–µ–Ω—Ç–∞</label>
<textarea id="complaints" placeholder="–û–ø–∏—à–∏—Ç–µ –∂–∞–ª–æ–±—ã –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ø–æ–¥—Ä–æ–±–Ω–æ..." disabled></textarea>
</div>
<div class="form-group">
<label for="anamnesis">–ê–Ω–∞–º–Ω–µ–∑ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è</label>
<textarea id="anamnesis" placeholder="–ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è..." disabled></textarea>
</div>
<div class="form-group">
<label for="objectiveStatus">–û–±—ä–µ–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–∞—Ç—É—Å</label>
<textarea id="objectiveStatus" placeholder="–î–∞–Ω–Ω—ã–µ –æ—Å–º–æ—Ç—Ä–∞: –ê–î, –ø—É–ª—å—Å, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –∏ —Ç.–¥." disabled></textarea>
</div>
</div>
<!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–∞—á–µ -->
<div class="form-section">
<h2 class="section-title">üë®‚Äç‚öïÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–∞—á–µ</h2>
<div class="form-row">
<div class="form-group">
<label for="doctorName" class="required">–§–ò–û –≤—Ä–∞—á–∞</label>
<input type="text" id="doctorName" placeholder="–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" disabled>
</div>
<div class="form-group">
<label for="doctorPosition" class="required">–î–æ–ª–∂–Ω–æ—Å—Ç—å</label>
<select id="doctorPosition" disabled>
<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å</option>
<option value="therapist">–¢–µ—Ä–∞–ø–µ–≤—Ç</option>
<option value="surgeon">–•–∏—Ä—É—Ä–≥</option>
<option value="neurologist">–ù–µ–≤—Ä–æ–ª–æ–≥</option>
<option value="psychiatrist">–ü—Å–∏—Ö–∏–∞—Ç—Ä</option>
<option value="cardiologist">–ö–∞—Ä–¥–∏–æ–ª–æ–≥</option>
<option value="nurse">–ú–µ–¥—Å–µ—Å—Ç—Ä–∞</option>
</select>
</div>
</div>
</div>
<!-- –ö–Ω–æ–ø–∫–∞ "–ö–æ–Ω–µ—Ü –≤–≤–æ–¥–∞" -->
<button class="btn btn-end" id="end-input-btn" style="display: none;">
<span>‚èπÔ∏è</span> –ö–æ–Ω–µ—Ü –≤–≤–æ–¥–∞
</button>
<div class="form-footer">
<p>–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –§–µ–¥–µ—Ä–∞–ª—å–Ω—ã–º –∑–∞–∫–æ–Ω–æ–º ‚Ññ152-–§–ó "–û –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"</p>
<p>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="last-update">-</span></p>
</div>
<div class="controls">
<button class="btn btn-primary" id="save-btn" disabled>
<span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
</button>
<button class="btn btn-secondary" id="reset-btn" disabled>
<span>üîÑ</span> –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
</button>
<button class="btn btn-outline" id="print-btn" disabled>
<span>üñ®Ô∏è</span> –ü–µ—á–∞—Ç—å –∫–∞—Ä—Ç—ã
</button>
<button class="btn btn-success" id="new-patient-btn" disabled>
<span>‚ûï</span> –ù–æ–≤—ã–π –ø–∞—Ü–∏–µ–Ω—Ç
</button>
</div>
</div>
<script>
class PatientCard {
constructor() {
// –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
this.operatorContainer = document.getElementById('operator-container');
this.patientContainer = document.getElementById('patient-container');
this.operatorNameInput = document.getElementById('operator-name');
this.operatorGroupInput = document.getElementById('operator-group');
this.operatorEnterBtn = document.getElementById('operator-enter-btn');
this.operatorErrorBox = document.getElementById('operator-error-box');
this.operatorNameDisplay = document.getElementById('operator-name-display');
this.operatorGroupDisplay = document.getElementById('operator-group-display');
this.changeOperatorBtn = document.getElementById('change-operator-btn'); // –ö–Ω–æ–ø–∫–∞ —Å–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
// –≠–ª–µ–º–µ–Ω—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º—ã
this.patientId = document.getElementById('patient-id');
this.creationDate = document.getElementById('creation-date');
this.birthDateInput = document.getElementById('birthDate');
this.ageInput = document.getElementById('age');
this.visitDateInput = document.getElementById('visitDate');
this.saveBtn = document.getElementById('save-btn');
this.resetBtn = document.getElementById('reset-btn');
this.printBtn = document.getElementById('print-btn');
this.newPatientBtn = document.getElementById('new-patient-btn');
this.errorBox = document.getElementById('error-box');
this.successBox = document.getElementById('success-box');
this.lastUpdate = document.getElementById('last-update');
this.emailInput = document.getElementById('email');
this.emailError = document.getElementById('email-error');
this.otherCheckbox = document.getElementById('other-checkbox').querySelector('input[type="checkbox"]');
this.otherDiseaseInputContainer = document.getElementById('other-disease-input');
this.otherDiseaseTextInput = document.getElementById('otherDiseaseText');
this.startInputBtn = document.getElementById('start-input-btn');
this.endInputBtn = document.getElementById('end-input-btn');
this.timerContainer = document.getElementById('timer-container');
this.timerDisplay = document.getElementById('timer-display');
this.timerStatus = document.getElementById('timer-status');
// –¢–∞–π–º–µ—Ä
this.timer = null;
this.startTime = null;
this.elapsedTime = 0;
this.isInputActive = false;
// –î–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
this.operatorName = '';
this.operatorGroup = '';
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
this.initEventListeners();
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ docx
this.checkDocxLibrary();
// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏–∑ localStorage
this.loadOperatorData();
}
checkDocxLibrary() {
if (typeof docx === 'undefined' || typeof docx.Packer === 'undefined') {
console.warn('–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ docx –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ü–µ—á–∞—Ç—å –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä–Ω—É—é –ø–µ—á–∞—Ç—å.');
this.docxAvailable = false;
} else {
this.docxAvailable = true;
console.log('–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ docx —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
}
}
initEventListeners() {
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–í–≤–æ–¥" –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
this.operatorEnterBtn.addEventListener('click', () => this.handleOperatorEnter());
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ "–°–º–µ–Ω–∏—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞"
this.changeOperatorBtn.addEventListener('click', () => this.changeOperator());
// –û—Å–Ω–æ–≤–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–æ—Ä–º—ã –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.birthDateInput.addEventListener('change', () => this.calculateAge());
this.saveBtn.addEventListener('click', () => this.savePatientData());
this.resetBtn.addEventListener('click', () => this.resetForm());
this.printBtn.addEventListener('click', () => this.generateWordDocument());
this.newPatientBtn.addEventListener('click', () => this.createNewPatient());
// –ö–Ω–æ–ø–∫–∏ –Ω–∞—á–∞–ª–∞ –∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤–≤–æ–¥–∞
this.startInputBtn.addEventListener('click', () => this.startInput());
this.endInputBtn.addEventListener('click', () => this.endInput());
// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –≤–≤–æ–¥–µ
document.querySelectorAll('input, textarea, select').forEach(element => {
element.addEventListener('blur', (e) => this.validateField(e.target));
});
// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—è "Email" –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
this.emailInput.addEventListener('input', (e) => {
this.validateEmail(e.target);
});
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —á–µ–∫–±–æ–∫—Å–∞ "–î—Ä—É–≥–æ–µ"
this.otherCheckbox.addEventListener('change', (e) => {
this.toggleOtherDiseaseInput(e.target.checked);
});
// –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
document.getElementById('phone').addEventListener('input', function(e) {
let value = e.target.value.replace(/\D/g, '');
// –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 7 –∏ –¥–ª–∏–Ω–∞ –±–æ–ª—å—à–µ 1, —É–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—É—é 7
if (value.startsWith('7') && value.length > 1) {
value = value.substring(1);
}
// –ï—Å–ª–∏ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ "7", —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤ "+7"
if (value === '7') {
e.target.value = '+7';
return;
}
// –ï—Å–ª–∏ –≤–≤–µ–¥–µ–Ω—ã —Ü–∏—Ñ—Ä—ã
if (value.length > 0) {
// –ï—Å–ª–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 7, —É–±–∏—Ä–∞–µ–º –µ–≥–æ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
if (value.startsWith('7') && value.length > 1) {
value = value.substring(1);
}
// –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É
let formatted = '+7';
if (value.length > 0) {
formatted += ' (' + value.substring(0, 3);
if (value.length > 3) {
formatted += ') ' + value.substring(3, 6);
if (value.length > 6) {
formatted += '-' + value.substring(6, 8);
if (value.length > 8) {
formatted += '-' + value.substring(8, 10);
}
}
}
}
e.target.value = formatted;
} else {
e.target.value = '+7';
}
});
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –°–ù–ò–õ–°
document.getElementById('insuranceNumber').addEventListener('input', function(e) {
let value = e.target.value.replace(/\D/g, '');
if (value.length > 0) {
if (value.length > 3) {
value = value.substring(0, 3) + '-' + value.substring(3);
}
if (value.length > 7) {
value = value.substring(0, 7) + '-' + value.substring(7);
}
if (value.length > 11) {
value = value.substring(0, 11) + ' ' + value.substring(11, 13);
}
e.target.value = value.substring(0, 14);
}
});
// –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –î–õ–Ø –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –í–í–û–î–ê –ì–û–î–ê –í –ü–û–õ–Ø–• –î–ê–¢–´
this.setupDateInputLimit();
}
// –ù–û–í–´–ô –ú–ï–¢–û–î: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤–≤–æ–¥–∞ –≥–æ–¥–∞ –¥–æ 4 —Å–∏–º–≤–æ–ª–æ–≤
setupDateInputLimit() {
// –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –ø–æ–ª—è —Ç–∏–ø–∞ date –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞
const dateInputs = this.patientContainer.querySelectorAll('input[type="date"]');
dateInputs.forEach(input => {
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ–±—ã—Ç–∏—è –≤–≤–æ–¥–∞
input.addEventListener('input', (e) => {
this.limitYearInput(e.target);
});
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
input.addEventListener('change', (e) => {
this.limitYearInput(e.target);
});
});
}
// –ù–û–í–´–ô –ú–ï–¢–û–î: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥–æ–¥–∞ –¥–æ 4 —Å–∏–º–≤–æ–ª–æ–≤
limitYearInput(input) {
let value = input.value;
if (value) {
let parts = value.split('-');
if (parts.length === 3) {
let year = parts[0];
// –ï—Å–ª–∏ –≥–æ–¥ –¥–ª–∏–Ω–Ω–µ–µ 4 —Å–∏–º–≤–æ–ª–æ–≤, –æ–±—Ä–µ–∑–∞–µ–º –¥–æ 4
if (year.length > 4) {
year = year.substring(0, 4);
input.value = `${year}-${parts[1]}-${parts[2]}`;
// –ï—Å–ª–∏ —ç—Ç–æ –ø–æ–ª–µ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è, –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –≤–æ–∑—Ä–∞—Å—Ç
if (input.id === 'birthDate') {
this.calculateAge();
}
// –ï—Å–ª–∏ —ç—Ç–æ –ø–æ–ª–µ –¥–∞—Ç—ã –≤—ã–¥–∞—á–∏ –ø–∞—Å–ø–æ—Ä—Ç–∞ –∏–ª–∏ –¥–∞—Ç—ã –æ–±—Ä–∞—â–µ–Ω–∏—è, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
}
}
}
}
handleOperatorEnter() {
const name = this.operatorNameInput.value.trim();
const group = this.operatorGroupInput.value.trim();
if (!name || !group) {
this.operatorErrorBox.style.display = 'block';
setTimeout(() => {
this.operatorErrorBox.style.display = 'none';
}, 3000);
return;
}
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
this.operatorName = name;
this.operatorGroup = group;
localStorage.setItem('operatorName', name);
localStorage.setItem('operatorGroup', group);
// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
this.operatorNameDisplay.textContent = name;
this.operatorGroupDisplay.textContent = group;
// –°–∫—Ä—ã—Ç–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏ –ø–æ–∫–∞–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.operatorContainer.classList.add('hidden');
this.patientContainer.classList.remove('hidden');
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.setupPatientForm();
}
loadOperatorData() {
const savedName = localStorage.getItem('operatorName');
const savedGroup = localStorage.getItem('operatorGroup');
if (savedName && savedGroup) {
this.operatorName = savedName;
this.operatorGroup = savedGroup;
this.operatorNameInput.value = savedName;
this.operatorGroupInput.value = savedGroup;
// –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã, —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.operatorContainer.classList.add('hidden');
this.patientContainer.classList.remove('hidden');
this.operatorNameDisplay.textContent = savedName;
this.operatorGroupDisplay.textContent = savedGroup;
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.setupPatientForm();
}
}
setupPatientForm() {
const today = new Date();
const formattedDate = today.toISOString().split('T')[0];
this.creationDate.textContent = this.formatDate(today);
this.visitDateInput.value = formattedDate;
this.lastUpdate.textContent = this.formatDateTime(today);
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞
const randomNum = Math.floor(1000 + Math.random() * 9000);
this.patientId.textContent = `PAT-${today.getFullYear()}-${randomNum}`;
this.calculateAge();
}
formatDate(date) {
return date.toLocaleDateString('ru-RU', {
day: '2-digit',
month: '2-digit',
year: 'numeric'
});
}
formatDateForDisplay(dateString) {
if (!dateString) return '';
const date = new Date(dateString);
return date.toLocaleDateString('ru-RU', {
day: '2-digit',
month: '2-digit',
year: 'numeric'
});
}
formatDateTime(date) {
return date.toLocaleDateString('ru-RU', {
day: '2-digit',
month: '2-digit',
year: 'numeric',
hour: '2-digit',
minute: '2-digit'
});
}
formatTime(seconds) {
const hrs = Math.floor(seconds / 3600);
const mins = Math.floor((seconds % 3600) / 60);
const secs = seconds % 60;
return [
hrs.toString().padStart(2, '0'),
mins.toString().padStart(2, '0'),
secs.toString().padStart(2, '0')
].join(':');
}
startInput() {
// –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –≤–≤–æ–¥–∞
this.clearFormWithoutConfirmation();
// –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–æ–ª—è –≤–≤–æ–¥–∞ –¢–û–õ–¨–ö–û –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.patientContainer.querySelectorAll('input:not([type="checkbox"]), textarea, select').forEach(field => {
if (field.id !== 'age') {
field.disabled = false;
}
});
// –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —á–µ–∫–±–æ–∫—Å—ã –¢–û–õ–¨–ö–û –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.patientContainer.querySelectorAll('input[type="checkbox"]').forEach(cb => {
cb.disabled = false;
});
// –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–æ–ø–∫–∏
this.saveBtn.disabled = false;
this.resetBtn.disabled = false;
this.printBtn.disabled = false;
this.newPatientBtn.disabled = false;
// –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ö–æ–Ω–µ—Ü –≤–≤–æ–¥–∞"
this.endInputBtn.style.display = 'block';
this.startInputBtn.style.display = 'none';
// –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∞–π–º–µ—Ä
this.startTime = new Date();
this.elapsedTime = 0;
this.timerContainer.classList.remove('hidden');
this.timerStatus.textContent = '–í–≤–æ–¥ –∞–∫—Ç–∏–≤–µ–Ω';
this.timerStatus.className = 'timer-status';
this.startTimer();
this.isInputActive = true;
// –§–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ
document.getElementById('lastName').focus();
this.showSuccess('–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—á–∞—Ç! –ó–∞–ø–æ–ª–Ω—è–π—Ç–µ —Ñ–æ—Ä–º—É.');
}
endInput() {
// –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–µ—Ä
this.stopTimer();
this.isInputActive = false;
// –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–æ–ª—è –≤–≤–æ–¥–∞ –¢–û–õ–¨–ö–û –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.patientContainer.querySelectorAll('input, textarea, select').forEach(field => {
field.disabled = true;
});
// –ö–Ω–æ–ø–∫–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å", "–û—á–∏—Å—Ç–∏—Ç—å", "–ü–µ—á–∞—Ç—å" –æ—Å—Ç–∞—é—Ç—Å—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏
this.saveBtn.disabled = false;
this.resetBtn.disabled = false;
this.printBtn.disabled = false;
this.newPatientBtn.disabled = false;
// –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É "–ù–∞—á–∞—Ç—å –≤–≤–æ–¥"
this.startInputBtn.style.display = 'block';
this.endInputBtn.style.display = 'none';
// –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ç–∞–π–º–µ—Ä–∞
this.timerStatus.textContent = '–í–≤–æ–¥ –∑–∞–≤–µ—Ä—à—ë–Ω';
this.timerStatus.className = 'timer-status stopped';
this.showSuccess(`–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à—ë–Ω! –í—Ä–µ–º—è –≤–≤–æ–¥–∞: ${this.timerDisplay.textContent}`);
}
startTimer() {
this.stopTimer();
const startTime = Date.now() - this.elapsedTime * 1000;
this.timer = setInterval(() => {
const elapsed = Math.floor((Date.now() - startTime) / 1000);
this.elapsedTime = elapsed;
this.timerDisplay.textContent = this.formatTime(elapsed);
}, 1000);
}
stopTimer() {
if (this.timer) {
clearInterval(this.timer);
this.timer = null;
}
}
toggleOtherDiseaseInput(show) {
if (show) {
this.otherDiseaseInputContainer.style.display = 'block';
this.otherDiseaseTextInput.focus();
} else {
this.otherDiseaseInputContainer.style.display = 'none';
this.otherDiseaseTextInput.value = '';
}
}
calculateAge() {
if (!this.birthDateInput.value) return;
const birthDate = new Date(this.birthDateInput.value);
const today = new Date();
let age = today.getFullYear() - birthDate.getFullYear();
const monthDiff = today.getMonth() - birthDate.getMonth();
if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
age--;
}
this.ageInput.value = age > 0 ? `${age} –ª–µ—Ç` : '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö';
}
validateEmail(field) {
const email = field.value.trim();
// –ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ - —É–±–∏—Ä–∞–µ–º –æ—à–∏–±–∫—É
if (email === '') {
field.classList.remove('invalid-email');
this.emailError.style.display = 'none';
return true;
}
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å–∏–º–≤–æ–ª–∞ "@" –∏ –¥–æ–º–µ–Ω–∞
if (!/.+@.+\..+/.test(email)) {
field.classList.add('invalid-email');
this.emailError.style.display = 'block';
return false;
} else {
field.classList.remove('invalid-email');
this.emailError.style.display = 'none';
return true;
}
}
validateField(field) {
const isRequired = field.classList.contains('required') || field.previousElementSibling?.classList.contains('required');
if (isRequired && !field.value.trim()) {
field.style.borderColor = '#dc3545';
return false;
} else {
field.style.borderColor = '#ddd';
return true;
}
}
validateForm() {
let isValid = true;
// –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
const requiredFields = [
'lastName', 'firstName', 'birthDate', 'gender', 'phone',
'visitDate', 'visitType', 'complaints', 'doctorName', 'doctorPosition'
];
requiredFields.forEach(fieldId => {
const field = document.getElementById(fieldId);
if (!field.value.trim()) {
field.style.borderColor = '#dc3545';
isValid = false;
} else {
field.style.borderColor = '#ddd';
}
});
// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—è "Email" (–µ—Å–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ)
if (this.emailInput.value.trim() !== '') {
if (!this.validateEmail(this.emailInput)) {
isValid = false;
}
}
// –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—è "–î—Ä—É–≥–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ" –µ—Å–ª–∏ —á–µ–∫–±–æ–∫—Å –≤—ã–±—Ä–∞–Ω
if (this.otherCheckbox.checked && !this.otherDiseaseTextInput.value.trim()) {
this.otherDiseaseTextInput.style.borderColor = '#dc3545';
isValid = false;
} else {
this.otherDiseaseTextInput.style.borderColor = '#ddd';
}
return isValid;
}
getChronicDiseasesText() {
const checkboxes = document.querySelectorAll('input[name="chronic"]:checked');
const diseases = [];
checkboxes.forEach(cb => {
if (cb.value === 'hypertension') diseases.push('–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è');
else if (cb.value === 'diabetes') diseases.push('–°–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç');
else if (cb.value === 'asthma') diseases.push('–ë—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–∞—è –∞—Å—Ç–º–∞');
else if (cb.value === 'heartDisease') diseases.push('–°–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è');
else if (cb.value === 'thyroid') diseases.push('–ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è —â–∏—Ç–æ–≤–∏–¥–Ω–æ–π –∂–µ–ª–µ–∑—ã');
else if (cb.value === 'other' && this.otherDiseaseTextInput.value.trim()) {
diseases.push(this.otherDiseaseTextInput.value.trim());
}
});
return diseases.length > 0 ? diseases.join(', ') : '–ù–µ —É–∫–∞–∑–∞–Ω—ã';
}
getChronicDiseases() {
const diseases = Array.from(document.querySelectorAll('input[name="chronic"]:checked'))
.map(cb => cb.value);
// –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ "–î—Ä—É–≥–æ–µ" –∏ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ
if (this.otherCheckbox.checked && this.otherDiseaseTextInput.value.trim()) {
const otherIndex = diseases.indexOf('other');
if (otherIndex > -1) {
diseases[otherIndex] = `other:${this.otherDiseaseTextInput.value.trim()}`;
}
}
return diseases;
}
savePatientData() {
if (!this.validateForm()) {
this.showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏ –∏—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏.');
return;
}
// –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
const patientData = {
patientId: this.patientId.textContent,
creationDate: this.creationDate.textContent,
lastName: document.getElementById('lastName').value,
firstName: document.getElementById('firstName').value,
middleName: document.getElementById('middleName').value,
birthDate: this.birthDateInput.value,
age: this.ageInput.value,
gender: document.getElementById('gender').value,
phone: document.getElementById('phone').value,
email: document.getElementById('email').value,
address: document.getElementById('address').value,
passportSeries: document.getElementById('passportSeries').value,
passportNumber: document.getElementById('passportNumber').value,
passportIssueDate: document.getElementById('passportIssueDate').value,
passportIssuedBy: document.getElementById('passportIssuedBy').value,
insuranceNumber: document.getElementById('insuranceNumber').value,
policyNumber: document.getElementById('policyNumber').value,
bloodType: document.getElementById('bloodType').value,
chronicDiseases: this.getChronicDiseases(),
allergies: document.getElementById('allergies').value,
medications: document.getElementById('medications').value,
visitDate: this.visitDateInput.value,
visitType: document.getElementById('visitType').value,
department: document.getElementById('department').value,
complaints: document.getElementById('complaints').value,
anamnesis: document.getElementById('anamnesis').value,
objectiveStatus: document.getElementById('objectiveStatus').value,
doctorName: document.getElementById('doctorName').value,
doctorPosition: document.getElementById('doctorPosition').value,
operatorName: this.operatorName,
operatorGroup: this.operatorGroup,
lastUpdate: new Date().toISOString(),
inputDuration: this.elapsedTime
};
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage
const patients = JSON.parse(localStorage.getItem('patients') || '[]');
const existingIndex = patients.findIndex(p => p.patientId === patientData.patientId);
if (existingIndex > -1) {
patients[existingIndex] = patientData;
} else {
patients.push(patientData);
}
localStorage.setItem('patients', JSON.stringify(patients));
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
this.lastUpdate.textContent = this.formatDateTime(new Date());
this.showSuccess('–î–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:', patientData);
}
// –ù–æ–≤—ã–π –º–µ—Ç–æ–¥: –æ—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
clearFormWithoutConfirmation() {
// –°–±—Ä–æ—Å –≤—Å–µ—Ö –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã –¢–û–õ–¨–ö–û –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.patientContainer.querySelectorAll('input:not([type="checkbox"]), textarea, select').forEach(field => {
if (field.id !== 'patient-id' && field.id !== 'creation-date' && field.id !== 'age') {
field.value = '';
}
});
// –°–±—Ä–æ—Å —á–µ–∫–±–æ–∫—Å–æ–≤ –¢–û–õ–¨–ö–û –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.patientContainer.querySelectorAll('input[type="checkbox"]').forEach(cb => {
cb.checked = false;
});
// –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¢–û–õ–¨–ö–û –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.patientContainer.querySelectorAll('input, textarea, select').forEach(field => {
field.style.borderColor = '#ddd';
field.classList.remove('invalid-email');
});
// –°–∫—Ä—ã—Ç—å –ø–æ–ª–µ "–î—Ä—É–≥–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ"
this.toggleOtherDiseaseInput(false);
// –°–∫—Ä—ã—Ç—å –æ—à–∏–±–∫–∏
this.emailError.style.display = 'none';
this.errorBox.style.display = 'none';
this.successBox.style.display = 'none';
// –°–±—Ä–æ—Å–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω
document.getElementById('phone').value = '+7';
// –°–±—Ä–æ—Å–∏—Ç—å –≤–æ–∑—Ä–∞—Å—Ç
this.ageInput.value = '';
// –ï—Å–ª–∏ —Ç–∞–π–º–µ—Ä –∞–∫—Ç–∏–≤–µ–Ω, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ
if (this.isInputActive) {
this.stopTimer();
this.startTimer();
}
}
resetForm() {
if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É? –í—Å–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
this.clearFormWithoutConfirmation();
}
}
generateWordDocument() {
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
if (!this.validateForm()) {
this.showError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø–µ—Ä–µ–¥ –ø–µ—á–∞—Ç—å—é.');
return;
}
// –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
const originalBtnText = this.printBtn.innerHTML;
this.printBtn.disabled = true;
this.printBtn.innerHTML = '<span class="loading"></span> –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞...';
// –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
const data = {
lastName: document.getElementById('lastName').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
firstName: document.getElementById('firstName').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
middleName: document.getElementById('middleName').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
birthDate: this.formatDateForDisplay(document.getElementById('birthDate').value) || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
age: document.getElementById('age').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
gender: (() => {
const val = document.getElementById('gender').value;
return val === 'male' ? '–ú—É–∂—Å–∫–æ–π' : (val === 'female' ? '–ñ–µ–Ω—Å–∫–∏–π' : '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª');
})(),
address: document.getElementById('address').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª',
phone: document.getElementById('phone').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª',
email: document.getElementById('email').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª',
passportSeries: document.getElementById('passportSeries').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
passportNumber: document.getElementById('passportNumber').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
passportIssueDate: this.formatDateForDisplay(document.getElementById('passportIssueDate').value) || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–∞¬ª',
passportIssuedBy: document.getElementById('passportIssuedBy').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
insuranceNumber: document.getElementById('insuranceNumber').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª',
policyNumber: document.getElementById('policyNumber').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª',
bloodType: document.getElementById('bloodType').options[document.getElementById('bloodType').selectedIndex].text || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–∞¬ª',
chronic: this.getChronicDiseasesText(),
allergies: document.getElementById('allergies').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω—ã¬ª',
medications: document.getElementById('medications').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω—ã¬ª',
visitDate: this.formatDateForDisplay(document.getElementById('visitDate').value) || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–∞¬ª',
visitType: document.getElementById('visitType').options[document.getElementById('visitType').selectedIndex].text || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª',
department: document.getElementById('department').options[document.getElementById('department').selectedIndex].text || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
complaints: document.getElementById('complaints').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω—ã¬ª',
anamnesis: document.getElementById('anamnesis').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª',
objectiveStatus: document.getElementById('objectiveStatus').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω¬ª',
doctorName: document.getElementById('doctorName').value.trim() || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
doctorPosition: document.getElementById('doctorPosition').options[document.getElementById('doctorPosition').selectedIndex].text || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–∞¬ª',
operatorName: this.operatorName || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–æ¬ª',
operatorGroup: this.operatorGroup || '¬´–Ω–µ —É–∫–∞–∑–∞–Ω–∞¬ª',
patientId: this.patientId.textContent,
inputDuration: this.formatTime(this.elapsedTime)
};
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É docx
try {
if (this.docxAvailable) {
this.generateDocxDocument(data);
} else {
// –†–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥: –±—Ä–∞—É–∑–µ—Ä–Ω–∞—è –ø–µ—á–∞—Ç—å
this.fallbackPrint(data);
}
} catch (error) {
console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞:', error);
this.showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞: ' + error.message);
this.printBtn.disabled = false;
this.printBtn.innerHTML = originalBtnText;
}
}
generateDocxDocument(data) {
const { Document, Paragraph, TextRun, HeadingLevel, AlignmentType, Packer } = docx;
// –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
const doc = new Document({
sections: [{
properties: {},
children: [
new Paragraph({
text: "–ö–∞—Ä—Ç–æ—á–∫–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞",
heading: HeadingLevel.HEADING_1,
alignment: AlignmentType.CENTER,
spacing: { after: 300 }
}),
new Paragraph({
children: [
new TextRun({ text: "–§–ò–û: ", bold: true }),
new TextRun(data.lastName + " " + data.firstName + " " + data.middleName)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: ", bold: true }),
new TextRun(data.birthDate + "   "),
new TextRun({ text: "–í–æ–∑—Ä–∞—Å—Ç: ", bold: true }),
new TextRun(data.age + "   "),
new TextRun({ text: "–ü–æ–ª: ", bold: true }),
new TextRun(data.gender)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–ê–¥—Ä–µ—Å –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è: ", bold: true }),
new TextRun(data.address)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–¢–µ–ª–µ—Ñ–æ–Ω: ", bold: true }),
new TextRun(data.phone + "   "),
new TextRun({ text: "E-mail: ", bold: true }),
new TextRun(data.email)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: ", bold: true }),
new TextRun(data.passportSeries + " " + data.passportNumber + " –æ—Ç " + data.passportIssueDate)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–í—ã–¥–∞–Ω: ", bold: true }),
new TextRun(data.passportIssuedBy)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "‚Ññ –°–ù–ò–õ–°: ", bold: true }),
new TextRun(data.insuranceNumber + "   "),
new TextRun({ text: "‚Ññ –ú–µ–¥. –ü–æ–ª–∏—Å–∞: ", bold: true }),
new TextRun(data.policyNumber + "   "),
new TextRun({ text: "–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏: ", bold: true }),
new TextRun(data.bloodType)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è: ", bold: true }),
new TextRun(data.chronic)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–ê–ª–ª–µ—Ä–≥–∏–∏: ", bold: true }),
new TextRun(data.allergies)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã: ", bold: true }),
new TextRun(data.medications)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–î–∞—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è: ", bold: true }),
new TextRun(data.visitDate + "   "),
new TextRun({ text: "–¢–∏–ø –æ–±—Ä–∞—â–µ–Ω–∏—è: ", bold: true }),
new TextRun(data.visitType + "   "),
new TextRun({ text: "–û—Ç–¥–µ–ª–µ–Ω–∏–µ: ", bold: true }),
new TextRun(data.department)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–ñ–∞–ª–æ–±—ã –ø–∞—Ü–∏–µ–Ω—Ç–∞: ", bold: true }),
new TextRun(data.complaints)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–ê–Ω–∞–º–Ω–µ–∑ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è: ", bold: true }),
new TextRun(data.anamnesis)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–û–±—ä–µ–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–∞—Ç—É—Å: ", bold: true }),
new TextRun(data.objectiveStatus)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–§–ò–û –ª–µ—á–∞—â–µ–≥–æ –≤—Ä–∞—á–∞: ", bold: true }),
new TextRun(data.doctorName)
],
spacing: { after: 100 }
}),
new Paragraph({
children: [
new TextRun({ text: "–î–æ–ª–∂–Ω–æ—Å—Ç—å: ", bold: true }),
new TextRun(data.doctorPosition)
],
spacing: { after: 300 }
}),
new Paragraph({
text: "___________________ / " + (data.doctorName.split(' ')[0] || '') + " /",
alignment: AlignmentType.RIGHT,
spacing: { after: 50 }
}),
new Paragraph({
text: "(–ø–æ–¥–ø–∏—Å—å)",
alignment: AlignmentType.RIGHT,
italics: true,
spacing: { after: 200 }
}),
new Paragraph({
children: [
new TextRun({ text: "–°—Ç—É–¥–µ–Ω—Ç: ", bold: true }),
new TextRun(data.operatorName + "   "),
new TextRun({ text: "–ì—Ä—É–ø–ø–∞: ", bold: true }),
new TextRun(data.operatorGroup + "   "),
new TextRun({ text: "–í—Ä–µ–º—è –≤–≤–æ–¥–∞: ", bold: true }),
new TextRun(data.inputDuration)
],
alignment: AlignmentType.LEFT,
spacing: { before: 100, after: 50 }
}),
]
}]
});
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
Packer.toBlob(doc).then(blob => {
const fileName = `–ö–∞—Ä—Ç–æ—á–∫–∞_–ø–∞—Ü–∏–µ–Ω—Ç–∞_${data.lastName}_${data.firstName}_${new Date().toISOString().split('T')[0]}.docx`;
saveAs(blob, fileName);
this.showSuccess(`–î–æ–∫—É–º–µ–Ω—Ç "${fileName}" —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!`);
console.log('–î–æ–∫—É–º–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ —Å–∫–∞—á–∞–Ω');
// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É
this.printBtn.disabled = false;
this.printBtn.innerHTML = '<span>üñ®Ô∏è</span> –ü–µ—á–∞—Ç—å –∫–∞—Ä—Ç—ã';
}).catch(error => {
console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ blob:', error);
this.showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥ –ø–µ—á–∞—Ç–∏.');
// –†–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥
this.fallbackPrint(data);
// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É
this.printBtn.disabled = false;
this.printBtn.innerHTML = originalBtnText;
});
}
fallbackPrint(data) {
// –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è –ø–µ—á–∞—Ç–∏
const printWindow = window.open('', '_blank', 'width=800,height=600');
printWindow.document.write(`
<!DOCTYPE html>
<html>
<head>
<title>–ö–∞—Ä—Ç–æ—á–∫–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –¥–ª—è –ø–µ—á–∞—Ç–∏</title>
<style>
body { font-family: Times New Roman, serif; font-size: 14pt; line-height: 1.5; padding: 40px; }
h1 { text-align: center; margin-bottom: 30px; font-size: 18pt }
p { margin: 10px 0; font-size: 14pt}
.bold { font-weight: bold; }
.signature { margin-top: 60px; text-align: right; }
.footer { margin-top: 40px; text-align: center; font-size: 12pt; }
</style>
</head>
<body onload="window.print(); setTimeout(window.close, 1000);">
<h1>–ö–∞—Ä—Ç–æ—á–∫–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞</h1>
<p><span class="bold">–§–ò–û:</span> ${data.lastName} ${data.firstName} ${data.middleName}</p>
<p><span class="bold">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è:</span> ${data.birthDate} &nbsp;&nbsp;&nbsp;
<span class="bold">–í–æ–∑—Ä–∞—Å—Ç:</span> ${data.age} &nbsp;&nbsp;&nbsp;
<span class="bold">–ü–æ–ª:</span> ${data.gender}</p>
<p><span class="bold">–ê–¥—Ä–µ—Å –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è:</span> ${data.address}</p>
<p><span class="bold">–¢–µ–ª–µ—Ñ–æ–Ω:</span> ${data.phone} &nbsp;&nbsp;&nbsp;
<span class="bold">E-mail:</span> ${data.email}</p>
<p><span class="bold">–ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:</span> ${data.passportSeries} ${data.passportNumber} –æ—Ç ${data.passportIssueDate}</p>
<p><span class="bold">–í—ã–¥–∞–Ω:</span> ${data.passportIssuedBy}</p>
<p><span class="bold">‚Ññ –°–ù–ò–õ–°:</span> ${data.insuranceNumber} &nbsp;&nbsp;&nbsp;
<span class="bold">‚Ññ –ú–µ–¥. –ü–æ–ª–∏—Å–∞:</span> ${data.policyNumber} &nbsp;&nbsp;&nbsp;
<span class="bold">–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏:</span> ${data.bloodType}</p>
<p><span class="bold">–•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</span> ${data.chronic}</p>
<p><span class="bold">–ê–ª–ª–µ—Ä–≥–∏–∏:</span> ${data.allergies}</p>
<p><span class="bold">–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã:</span> ${data.medications}</p>
<p><span class="bold">–î–∞—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è:</span> ${data.visitDate} &nbsp;&nbsp;&nbsp;
<span class="bold">–¢–∏–ø –æ–±—Ä–∞—â–µ–Ω–∏—è:</span> ${data.visitType} &nbsp;&nbsp;&nbsp;
<span class="bold">–û—Ç–¥–µ–ª–µ–Ω–∏–µ:</span> ${data.department}</p>
<p><span class="bold">–ñ–∞–ª–æ–±—ã –ø–∞—Ü–∏–µ–Ω—Ç–∞:</span> ${data.complaints}</p>
<p><span class="bold">–ê–Ω–∞–º–Ω–µ–∑ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:</span> ${data.anamnesis}</p>
<p><span class="bold">–û–±—ä–µ–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–∞—Ç—É—Å:</span> ${data.objectiveStatus}</p>
<p><span class="bold">–§–ò–û –ª–µ—á–∞—â–µ–≥–æ –≤—Ä–∞—á–∞:</span> ${data.doctorName}</p>
<p><span class="bold">–î–æ–ª–∂–Ω–æ—Å—Ç—å:</span> ${data.doctorPosition}</p>
<div class="signature">
___________________ / ${data.doctorName.split(' ')[0] || ''} /
<div style="font-style: italic;">(–ø–æ–¥–ø–∏—Å—å)</div>
</div>
<div class="footer">
–°—Ç—É–¥–µ–Ω—Ç: ${data.operatorName} &nbsp;&nbsp;&nbsp; –ì—Ä—É–ø–ø–∞: ${data.operatorGroup} &nbsp;&nbsp;&nbsp; –í—Ä–µ–º—è –≤–≤–æ–¥–∞: ${data.inputDuration}
</div>
</body>
</html>
`);
// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É
this.printBtn.disabled = false;
this.printBtn.innerHTML = '<span>üñ®Ô∏è</span> –ü–µ—á–∞—Ç—å –∫–∞—Ä—Ç—ã';
this.showSuccess('–û—Ç–∫—Ä—ã—Ç–æ –æ–∫–Ω–æ –ø–µ—á–∞—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞. –í—ã–±–µ—Ä–∏—Ç–µ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ PDF" –∏–ª–∏ "–ü–µ—á–∞—Ç—å".');
}
createNewPatient() {
if (confirm('–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É –ø–∞—Ü–∏–µ–Ω—Ç–∞? –¢–µ–∫—É—â–∏–µ –Ω–µ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø–æ—Ç–µ—Ä—è–Ω—ã.')) {
// –ï—Å–ª–∏ –≤–≤–æ–¥ –∞–∫—Ç–∏–≤–µ–Ω, –∑–∞–≤–µ—Ä—à–∏—Ç—å –µ–≥–æ
if (this.isInputActive) {
this.endInput();
}
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ –ø–∞—Ü–∏–µ–Ω—Ç–∞
const today = new Date();
const randomNum = Math.floor(1000 + Math.random() * 9000);
this.patientId.textContent = `PAT-${today.getFullYear()}-${randomNum}`;
this.creationDate.textContent = this.formatDate(today);
// –û—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã
this.clearFormWithoutConfirmation();
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã
this.visitDateInput.value = today.toISOString().split('T')[0];
this.lastUpdate.textContent = this.formatDateTime(today);
// –°–∫—Ä—ã—Ç—å —Ç–∞–π–º–µ—Ä
this.timerContainer.classList.add('hidden');
}
}
showError(message) {
this.errorBox.textContent = message;
this.errorBox.style.display = 'block';
this.successBox.style.display = 'none';
setTimeout(() => {
this.errorBox.style.display = 'none';
}, 5000);
}
showSuccess(message) {
this.successBox.textContent = message;
this.successBox.style.display = 'block';
this.errorBox.style.display = 'none';
setTimeout(() => {
this.successBox.style.display = 'none';
}, 5000);
}
// –ù–æ–≤—ã–π –º–µ—Ç–æ–¥: —Å–º–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Å —Å–∫—Ä—ã—Ç–∏–µ–º —Ç–∞–π–º–µ—Ä–∞
changeOperator() {
// –ï—Å–ª–∏ –≤–≤–æ–¥ –∞–∫—Ç–∏–≤–µ–Ω, –∑–∞–≤–µ—Ä—à–∏—Ç—å –µ–≥–æ
if (this.isInputActive) {
this.endInput();
}
// –°–∫—Ä—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
this.timerContainer.classList.add('hidden');
// –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –ø–∞—Ü–∏–µ–Ω—Ç–∞
this.patientContainer.classList.add('hidden');
// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
this.operatorContainer.classList.remove('hidden');
// –û—á–∏—â–∞–µ–º –ø–æ–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
this.operatorNameInput.value = '';
this.operatorGroupInput.value = '';
// –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –≤ –∫–ª–∞—Å—Å–µ
this.operatorName = '';
this.operatorGroup = '';
// –£–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∏–∑ localStorage
localStorage.removeItem('operatorName');
localStorage.removeItem('operatorGroup');
// –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ
this.operatorNameDisplay.textContent = '-';
this.operatorGroupDisplay.textContent = '-';
this.showSuccess('–§–æ—Ä–º–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –≤–≤–æ–¥–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö');
}
}
document.addEventListener('DOMContentLoaded', () => {
window.patientCard = new PatientCard();
// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
setTimeout(() => {
if (typeof docx === 'undefined') {
console.warn('–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ docx –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ë—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –º–µ—Ç–æ–¥ –ø–µ—á–∞—Ç–∏.');
}
}, 1000);
});
</script>
</body>
</html>
